<div class="main-section">
    <div class="actions">
        <!-- Search Input -->
        <div class="search-style">
            <input class="input-style" type="text" #searchQuery placeholder="Search Books">
            <button class="search-btn" (click)="onSearch(searchQuery.value)">
                <mat-icon aria-hidden="false" aria-label="search icon" fontIcon="search"></mat-icon>
            </button>
        </div>
    </div>

    <!-- <ng-container *ngIf="(favoriteBooks | async) as favoriteBooks">
            <div>{{favoriteBooks.length}}</div>
            <div *ngFor="let book of favoriteBooks">
                <span>{{book?.title}}</span>
                <span>Favorite: {{book.favorite}}</span>
            </div>
        </ng-container> -->

    <!-- Error Message -->
    <div *ngIf="error | async as error" class="error">
        {{ error }}
    </div>

    <!-- Loading Indicator -->
    <div *ngIf="loading | async" class="loading">
        Loading...
    </div>

    <!-- List of Filtered Books -->
    <ng-container *ngIf="(filteredBooks$ | async) as bookList">
        <ng-container *ngIf="bookList.length > 0; else allBooks">
            <mat-card *ngFor="let book of bookList">
                <mat-card-header>
                    <div mat-card-avatar [ngStyle]="{ 'background-image': 'url(' + book.avatar + ')' }"></div>
                    <mat-card-title routerLink="/book-detail/{{book.id}}">{{book.title}}</mat-card-title>
                    <mat-card-subtitle>{{book.author}}</mat-card-subtitle>
                </mat-card-header>
                <mat-card-content>
                    <img mat-card-image class="image-style" [src]="book.img">
                </mat-card-content>
                <mat-card-actions>
                    <button mat-button (click)="selectBook(book.id)" class="update">Update</button>
                    <mat-icon [ngStyle]="{ 'color': (book.favorite) ? 'red' : 'lightgrey'}" class="favorite"
                        (click)="book.favorite ? removeFromFavorites(book.id) : addToFavorites(book.id)">favorite
                    </mat-icon>
                    <mat-icon>delete</mat-icon>
                </mat-card-actions>
            </mat-card>
        </ng-container>
    </ng-container>
    <!-- List of Items -->
    <ng-template #allBooks>
        <mat-card *ngFor="let book of books">
            <mat-card-header>
                <div mat-card-avatar [ngStyle]="{ 'background-image': 'url(' + book.avatar + ')' }"></div>
                <mat-card-title routerLink="/book-detail/{{book.id}}">{{book.title}}</mat-card-title>
                <mat-card-subtitle>{{book.author}}</mat-card-subtitle>
            </mat-card-header>
            <mat-card-content>
                <img mat-card-image class="image-style" [src]="book.img">
            </mat-card-content>
            <mat-card-actions>
                <button mat-button (click)="selectBook(book.id)" class="update">Update</button>
                <div class="action-style">
                    <mat-icon [ngStyle]="{ 'color': (book.favorite) ? 'red' : 'lightgrey'}" class="favorite"
                        (click)="book.favorite ? removeFromFavorites(book.id) : addToFavorites(book.id)">favorite
                    </mat-icon>
                    <mat-icon>delete</mat-icon>
                </div>
            </mat-card-actions>
        </mat-card>
    </ng-template>


    <app-edit-book *ngIf="selectedBookID" [selectedBook]="selectedBookID" (signalChild)="getSignal($event)"
        (successEvent)="showPopup()"></app-edit-book>
</div>